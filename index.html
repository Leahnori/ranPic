<html>
	<head>
		<style >
			body {
				font-family: "Courier New";
			}
			p {
				font-size:300%;
				padding:10px;
				font-weight:bold;
				margin:5px;
			}
			#wrapper, #menu,#rand {
				width:90%;
				background-color:#FFFFFF;
				margin-right:auto;
				margin-left:auto;
				text-align:center;
				margin-top:5px;
				margin-bottom:5px;
				font-size:x-large;
				font-weight:bold;
				padding:5px;
			}
			#fig, #in,#back, #out {
				width:90%;
				background-color:#FFFFFF;
				margin-right:auto;
				margin-left:auto;
				text-align:center;
				margin-top:5px;
				margin-bottom:5px;
				font-size:x-large;
				font-weight:bold;
				padding:5px;
				display:none;
			 }
			#vica, #ind {
				width:90%;
				background-color:#FFFFFF;
				margin-right:auto;
				margin-left:auto;
				text-align:center;
				margin-top:5px;
				margin-bottom:5px;
				font-size:x-large;
				font-weight:bold;
				padding:5px;
				display:none;
				
			}
			#canvas {
				padding:10px;
			}
			textarea {
				width:100%;
				outline: none;
				resize: none;
				border: none;
				font-size:x-large;
				font-family: "Courier New";
				font-weight:bold;
				text-align:center;
			}
			#b {
				background-color:#ffffff;
				cursor:pointer;
				color:#000000;
				font-family:Courier New;
				font-size:x-large;
				font-weight:bold;
				text-decoration:none;
				border: none;
				outline:none;
			}
			#create {
				background-color:#ffffff;
				cursor:pointer;
				color:#000000;
				font-family:Courier New;
				font-size:xx-large;
				font-weight:bold;
				text-decoration:none;
				border: none;
				outline:none;
			}
			a{
				text-decoration: none;
				color: black;
			}
			
		</style>
	</head>
	<body>
		<div id="wrapper" >
		   	<p>ranPic</p>
		</div>
		<div id="menu">
			<span><input id="b" type="button" value="stats" onClick="change('fig')"></span>
			<span><input id="b" type="button" value="input" onClick="change('in')"></span>  <!--both from textarea, file and tweet-->
			<!--span><input id="b" type="button" value="output" onClick="change('out')"></span> <both file and pic download-->
		</div>

		<div id="rand" >
		    <canvas id="canvas" width="256", height="256" onClick="location.reload()">random Canvas</canvas>
		</div>

		<!--div id="ind" ></div--> <!--containing 1s and 0s-->

		<div id="fig"></div>

		<div id="in">
			<textarea id="text" placeholder="put here the code! :) you can use 0s or 1s to code it!" rows=8 ></textarea>
			<input id="b" type="button" value="visualize!" onClick="visualize()">
			
		</div>

		<div id="vica">
			<canvas id="vican" width="256", height="256" >visualized canvas</canvas>
		</div>

		<div id="out">
			<button id="create">create file</button> 
			<a download="info.txt" id="downloadlink" style="display: none">download</a>
		</div>	

		<div id="back">
			<span><input id="b" type="button" value="back" onClick="back()"></span>
		</div>

		<div id="twitter" style="text-align:center">
			<a class="twitter-share-button" href="https://twitter.com/share" data-via="ranPicpat">share pattern!</a>
		</div>			
	</body>
</html>

<script type="text/javascript">

var current="";
var code="";

window.twttr=(function(d,s,id) {
    var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr|| {};
    if (d.getElementById(id))return;
    js=d.createElement(s);
    js.id=id;
    js.src="https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);
    t._e=[];
    t.ready=function(f) {
        t._e.push(f);
    };
    return t;
}(document,"script","twitter-wjs"));

var zoom=32;
var prop=8;
var bigIndex=[];
	
function setPixel(imageData, x, y, r, g, b, a) {
    index = (x + y * imageData.width) * 4;
    imageData.data[index+0] = r;
    imageData.data[index+1] = g;
    imageData.data[index+2] = b;
    imageData.data[index+3] = a;
}
rand();
function rand() {
    var color=Math.floor(Math.random()*16777215).toString(16);
    while (color.length<6) {
        color=Math.floor(Math.random()*16777215).toString(16);
    }
    document.body.style.background='#'+color;

    element = document.getElementById("canvas");
    c = element.getContext("2d");

    width = element.width;
    height = element.height;

    imageData = c.createImageData(width, height);
    var m=0;

    for (var x=0;x<width;x=x+zoom) {
        var smIndex=[];
        for (var y=0;y<height;y=y+zoom) {
            s = Math.floor(Math.random() * 2 );
            m=m+s;
            var dot=1;
            if (s==0) {
                r = 0;
                g = 0;
                b = 0;
            } else {
                r = 255;
                g = 255;
                b = 255;
                dot=0;
            }
            smIndex[smIndex.length]=dot;
            for ( var a=0;a<zoom;a++) {
                for (var e=0;e<zoom;e++ ) {
                    setPixel(imageData, y+a, x+e, r, g, b, 255); // 255 opaque
                }
            }

        }
        bigIndex[bigIndex.length]=smIndex;
    }

    for (var q=0;q<prop;q++) {
        for (var r=0;r<prop;r++) {
            //document.getElementById('ind').innerHTML += bigIndex[q][r]+' ';
            document.title += bigIndex[q][r];
            code+=bigIndex[q][r];
        }
        //document.getElementById('ind').innerHTML += '<br>';
    }

    document.title+=" Random images";

    c.putImageData(imageData, 0, 0);
	
	var horlinbla=0;
	var verlinbla=0;
	var horlinwhi=0;
	var verlinwhi=0;

    for (var q=0;q<prop;q++) {
		var w=0;
        for (var r=0;r<prop;r++) {
			if(bigIndex[q][r]==1)  {
				w++;
			}
		}
		if(w==prop) {
			horlinbla++;
		}
	}
	for (var r=0;r<prop;r++) {
		var w=0;
        for (var q=0;q<prop;q++) {
			if(bigIndex[q][r]==1)  {
				w++;
			}
		}
		if(w==prop) {
			verlinbla++;
		}
	}
	 for (var q=0;q<prop;q++) {
		var w=0;
        for (var r=0;r<prop;r++) {
			if(bigIndex[q][r]==0)  {
				w++;
			}
		}
		if(w==prop) {
			horlinwhi++;
		}
	}
	for (var r=0;r<prop;r++) {
		var w=0;
        for (var q=0;q<prop;q++) {
			if(bigIndex[q][r]==0)  {
				w++;
			}
		}
		if(w==prop) {
			verlinwhi++;
		}
	}
	var blacross=0;
	var whitecross=0;
	
	for(var i=0;i<=prop-3;i++) {
		for(var j=0;j<=prop-3;j++) {
			if(bigIndex[j][i]==0&&bigIndex[j][i+1]==1&&bigIndex[j][i+2]==0&&
			bigIndex[j+1][i]==1&&bigIndex[j+1][i+1]==1&&bigIndex[j+1][i+2]==1&&
			bigIndex[j+2][i]==0&&bigIndex[j+2][i+1]==1&&bigIndex[j+2][i+2]==0) {
				blacross++;
			}
			if(bigIndex[j][i]==1&&bigIndex[j][i+1]==0&&bigIndex[j][i+2]==1&&
			bigIndex[j+1][i]==0&&bigIndex[j+1][i+1]==0&&bigIndex[j+1][i+2]==0&&
			bigIndex[j+2][i]==1&&bigIndex[j+2][i+1]==0&&bigIndex[j+2][i+2]==1) {
				whitecross++;
			}
		}
	}
	var blacksquare=0;
	var whitesquare=0;
	for(var i=0;i<=prop-3;i++) {
		for(var j=0;j<=prop-3;j++) {
			if(bigIndex[j][i]==1&&bigIndex[j][i+1]==1&&bigIndex[j][i+2]==1&&
			bigIndex[j+1][i]==1&&bigIndex[j+1][i+1]==1&&bigIndex[j+1][i+2]==1&&
			bigIndex[j+2][i]==1&&bigIndex[j+2][i+1]==1&&bigIndex[j+2][i+2]==1) {
				blacksquare++;
			}
			if(bigIndex[j][i]==0&&bigIndex[j][i+1]==0&&bigIndex[j][i+2]==0&&
			bigIndex[j+1][i]==0&&bigIndex[j+1][i+1]==0&&bigIndex[j+1][i+2]==0&&
			bigIndex[j+2][i]==0&&bigIndex[j+2][i+1]==0&&bigIndex[j+2][i+2]==0) {
				whitesquare++;
			}
		}
	}
	var maxbla=0;
	var maxwhi=0;
	for(var i=0;i<prop;i++) {
		for(var j=0;j<prop;j++) {
				if(i>=j) {
					for(var t=(prop-i-1);t>=0;t--) {
						var o=0;
						var p=0;
						for(var a=i;a<=(t+i);a++) {
							for(var b=j;b<=(j+t);b++) {
								if(bigIndex[a][b]==1) {
									o++;
								}
								if(bigIndex[a][b]==0) {
									p++;
								}
							}
						}
						var sq=(t+1)*(t+1);
						if(o==sq&&(t+1)>maxbla) {
							maxbla=t+1;
						}
						if(p==sq&&(t+1)>maxwhi) {
							maxwhi=t+1;
						}
						
					}
				} else if(i<j) {
					for(var t=prop-j-1;t>=0;t--) {
						var o=0;
						var p=0;
						for(var a=i;a<=(t+i);a++) {
							for(var b=j;b<=(j+t);b++) {
								if(bigIndex[a][b]==1) {
									o++;
								}
								if(bigIndex[a][b]==0) {
									p++;
								}
							}
						}
						var sq=(t+1)*(t+1);
						if(o==sq&&(t+1)>maxbla) {
							maxbla=t+1;
						}
						if(p==sq&&(t+1)>maxwhi) {
							maxwhi=t+1;
						}
					}
				}
		}
	}	
	
document.getElementById('fig').innerHTML += (prop*prop-m) + " number of black pieces <br>";
document.getElementById('fig').innerHTML += m+" number of white pieces <br>";
document.getElementById('fig').innerHTML += horlinbla + " number of horizontal full black lines <br>";
document.getElementById('fig').innerHTML += verlinbla + " number of vertical full black lines <br>";
document.getElementById('fig').innerHTML += horlinwhi + " number of horizontal full white lines <br>";
document.getElementById('fig').innerHTML += verlinwhi + " number of vertical full white lines <br>";
document.getElementById('fig').innerHTML += blacross + " number of black cross <br>";
document.getElementById('fig').innerHTML += whitecross + " number of white cross <br>";
document.getElementById('fig').innerHTML += blacksquare + " number of black 3x3 square <br>";
document.getElementById('fig').innerHTML += whitesquare + " number of white 3x3 square <br>";
document.getElementById('fig').innerHTML += maxbla+"x"+maxbla + " biggest black square size <br>";
document.getElementById('fig').innerHTML += maxwhi+"x"+maxwhi + " biggest white square size <br>";


}


function setCharAt(str,index,chr) {
    if(index > str.length-1) return str;
    return str.substr(0,index) + chr + str.substr(index+1);
}
function visualize() {
	var da=document.getElementById("text").value;
	for(var o=0;o<da.length;o++) {
		var i=da.charAt(o).toString();
		if(i!="1"&&i!="0") {
			da=setCharAt(da,o,"");
			o--;
		}
	}
	if(da.length<64) {
		for(var t=da.length;t<prop*prop;t++) {
			da=da+"0";
		}
	} else if(da.length>64) {
		da=da.substr(0,64);
	}

	element = document.getElementById("vican");
    c = element.getContext("2d");

    width = element.width;
    height = element.height;

    imageData = c.createImageData(width, height);

    for (var x=0;x<8;x++) {
        for (var y=0;y<8;y++) {
            var s=da.charAt(x*8+y);
            if (s==1) {
                r = 0;
                g = 0;
                b = 0;
            } else {
                r = 255;
                g = 255;
                b = 255;
            }
            for ( var a=0;a<zoom;a++) {
                for (var e=0;e<zoom;e++ ) {
                    setPixel(imageData, y*32+a, x*32+e, r, g, b, 255); // 255 opaque
                }
            }
        }
    }

    c.putImageData(imageData, 0, 0);
    document.getElementById("vica").style.display="block";
}
function change(one) {
	current=one;
	document.getElementById(one).style.display="block";
	document.getElementById("back").style.display="block";
	document.getElementById("rand").style.display="none";
	document.getElementById("menu").style.display="none";
	document.getElementById("vica").style.display="none";
	document.getElementById("twitter").style.display="none";
}

function back() {
	document.getElementById("menu").style.display="block";
	document.getElementById("rand").style.display="block";
	document.getElementById(current).style.display="none";
	document.getElementById("vica").style.display="none";
	document.getElementById("back").style.display="none";
	document.getElementById("twitter").style.display="block";

}

var textFile = null;
function makeTextFile(text) {
    var data = new Blob([text], {type: 'text/plain'});

    if (textFile !== null) {
      window.URL.revokeObjectURL(textFile);
    }

    textFile = window.URL.createObjectURL(data);

    return textFile;
}

var create = document.getElementById('create');
var textbox = document.getElementById('textbox');

create.addEventListener('click', function () {
    var link = document.getElementById('downloadlink');
    link.href = makeTextFile(code);
    link.style.display = 'block';
}, false);

</script>

